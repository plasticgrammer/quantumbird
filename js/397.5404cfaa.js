"use strict";(self["webpackChunkweekly_report"]=self["webpackChunkweekly_report"]||[]).push([[397],{7397:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});a(4114);var l=a(689),o=a(834),n=a(9423);const c="/user-tasks",r=async e=>n.uE.post(c,e),d=async e=>n.uE.put(c,e),s=async(e,t)=>n.uE.delete(c,{userId:e,taskId:t}),i=async e=>n.uE.get(c,{userId:e});var u=a(3571),p=a(9244),m=a(2799),k=a(7495);const y={key:0,class:"pa-0"},v={key:1};var h={__name:"TodoListWidget",setup(e){const t=(0,o.Pj)(),a=(0,l.ref)(null),n=(0,l.ref)([]),c=(0,l.ref)(""),h=(0,l.computed)((()=>n.value.some((e=>e.completed)))),f=t.getters["auth/cognitoUserSub"],w=async()=>{try{if(!f)return;const e=await i(f);e&&Array.isArray(e)?n.value=e:n.value=[]}catch(e){n.value=[]}},g=async e=>{"Enter"!==e.key||e.isComposing||(e.preventDefault(),await C())},C=async()=>{if(c.value.trim()&&f)try{const e={title:c.value.trim(),userId:f,createdAt:(new Date).toISOString(),completed:!1},t=await r(e);n.value.push(t),c.value=""}catch(a){}},B=async e=>{try{await d({...e,completed:e.completed})}catch(a){e.completed=!e.completed}},V=async()=>{if(!f)return;const e=n.value.filter((e=>e.completed));a.value=null;try{await Promise.all(e.map((e=>s(f,e.taskId)))),n.value=n.value.filter((e=>!e.completed))}catch(t){}};return(0,l.onMounted)(w),(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(u.A,{"widget-id":"todo",title:"やることリスト",icon:"mdi-clipboard-check-outline"},{"header-append":(0,l.withCtx)((()=>[h.value?((0,l.openBlock)(),(0,l.createBlock)(p.D,{key:0,color:"error",size:"small",variant:"outlined",onClick:V},{default:(0,l.withCtx)((()=>t[2]||(t[2]=[(0,l.createTextVNode)(" 完了済み削除 ")]))),_:1})):(0,l.createCommentVNode)("",!0)])),default:(0,l.withCtx)((()=>[n.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)("div",y,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n.value,(e=>((0,l.openBlock)(),(0,l.createBlock)(m.a,{key:e.taskId,modelValue:e.completed,"onUpdate:modelValue":t=>e.completed=t,color:"info",class:"todo-item pa-0","hide-details":"",density:"compact",onChange:t=>B(e)},{label:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",{class:(0,l.normalizeClass)({"text-decoration-line-through":e.completed})},(0,l.toDisplayString)(e.title),3)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)("p",v,"タスクがありません")),(0,l.createVNode)(k.W,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),label:"新しいタスク","hide-details":"","single-line":"",density:"compact",class:"mt-2","append-inner-icon":"mdi-plus","onClick:appendInner":C,onKeydown:t[1]||(t[1]=(0,l.withKeys)((e=>g(e)),["enter"]))},null,8,["modelValue"])])),_:1}))}},f=a(6262);const w=(0,f.A)(h,[["__scopeId","data-v-aac8cf50"]]);var g=w}}]);
//# sourceMappingURL=397.5404cfaa.js.map